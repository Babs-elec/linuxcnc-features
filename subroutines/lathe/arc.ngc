(Add line)
O<add-line> SUB
	#<x> =  #2
	#<y> =  #3
	O<alpha_at_move_end> CALL [1] [#<x>] [#<y>]
	O<add-line-if> IF [#<_plane> EQ 17] (XY)
		G01 X#<x> Y#<y> 
	O<add-line-if> ELSEIF [#<_plane> EQ 18] (XZ)
		G01 X#<x> Z#<y>
	O<add-line-if> ELSEIF [#<_plane> EQ 19] (YZ)
		G01 Y#<x> Z#<y>
	O<add-line-if> ENDIF
O<add-line> ENDSUB


(Add arc sub)
(G x y i j)
O<add-arc> SUB
	#<gcode> = #1
	#<x> =  #2
	#<y> =  #3
	#<i> =  #4
	#<j> =  #5
	
	O<get-local> CALL (get current coords)
	#<g3mult> = [5-#<gcode>*2] (convert to -1 for G03 1 for G02) 
	
	O<add-arc-if> IF [#<_plane> EQ 17] (XY)
		O<alpha_at_move_end> CALL [1] [-#<g3mult>*[#<y>-#<_yl>-#<j>]] [#<x>-#<_xl>-#<i>]
		G#<gcode> X#<x> Y#<y> I#<i> J#<j> 
	O<add-arc-if> ELSEIF [#<_plane> EQ 18] (XZ)
		O<alpha_at_move_end> CALL [1] [-#<g3mult>*[#<y>-#<_zl>-#<j>]] [#<x>-#<_xl>-#<i>]
		G#<gcode> X#<x> Z#<y> I#<i> K#<j> 
	O<add-arc-if> ELSEIF [#<_plane> EQ 19] (YZ)
		O<alpha_at_move_end> CALL [1] [-#<g3mult>*[#<y>-#<_zl>-#<j>]] [#<x>-#<_yl>-#<i>]
		G#<gcode> Y#<x> Z#<y> J#<i> K#<j> 
	O<add-arc-if> ENDIF
	
O<add-arc> ENDSUB


(Add tangent arc)
(x,y,r,a,dx)
O<add-tangent-arc> SUB
	(#<gcode> = #1)
	#<r> =  #2
	#<a> =  #3
	#<x1> = #4
	O<get-local> CALL (get current local position)
	#<i> = [-SIN[#<a>]*#<r>]
	#<j> = [ COS[#<a>]*#<r>]
	#<cx> = #<_lx> + #<i> 
	#<cy> = #<_ly> + #<j> 
	O<add-tangetn-arc-paranoid> IF [#<_paranoid> GT 0] (Will raise an error while preview)
		<y1> = [ SQRT[ #<r>*#<r> - [#<x1>-#<cx>]*[#<x1>-#<cx>] ] + #<cy> ]	
		O<add-arc> [#1] [#<x1>] [#<y1>] [#<i>] [#<j>]		
	O<add-tangetn-arc-paranoid> ELSE
		O<add-tangetn-arc-paranod-01> IF [ [#<r>*#<r> - [#<x1>-#<cx>]*[#<x1>-#<cx>]] GT 0 ]
			<y1> = [ SQRT[ #<r>*#<r> - [#<x1>-#<cx>]*[#<x1>-#<cx>] ] + #<cy> ]	
			O<add-arc> [#1] [#<x1>] [#<y1>] [#<i>] [#<j>]
		O<add-tangetn-arc-paranod-01> ELSE
			O<add-line> [#<x1>] [#<_ly>]
		O<add-tangetn-arc-paranod-01> ENDIF
	O<add-tangetn-arc-paranoid> ENDIF 
	 
O<add-tangent-arc> ENDSUB 


